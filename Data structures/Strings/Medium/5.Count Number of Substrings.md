
Count Number of Substrings


**Problem Statement:** You are given a string s and a positive integer k.  
Return the number of substrings that contain exactly k distinct characters.

**Examples**

**Example 1:****Input:** s = "pqpqs", k = 2  
**Output:** 7  
**Explanation:**  All substrings with exactly 2 distinct characters:  
"pq", "pqp", "pqpq", "qp", "qpq", "pqs", "qs"  
Total = 7.

**Example 2:****Input:** s = "abcbaa", k = 3  
**Output:** 5  
**Explanation:**  All substrings with exactly 3 distinct characters:  
"abc", "abcb", "abcba", "bcba", "cbaa"  
Total = 5.

Approach

Algorithm

- Define a helper function atMostKDistinct(s, k):

- Use a sliding window with two pointers (left and right) and a frequency map.
- Expand the window by moving the right pointer and count characters.
- If the count of distinct characters exceeds k, shrink the window by moving the left pointer.
- For each valid window, add (right - left + 1) to the result.

- To find substrings with exactly k distinct characters, calculate:

- atMostKDistinct(s, k) - atMostKDistinct(s, k-1)

Code

C++JavaPythonJavaScript

```java
import java.util.*;

class Solution {
    // Function to count substrings with at most k distinct characters
    public static int atMostKDistinct(String s, int k) {
        int left = 0, res = 0;
        Map<Character, Integer> freq = new HashMap<>();

        // Iterate with right pointer
        for (int right = 0; right < s.length(); right++) {
            freq.put(s.charAt(right), freq.getOrDefault(s.charAt(right), 0) + 1);

            // Shrink window if distinct characters exceed k
            while (freq.size() > k) {
                char leftChar = s.charAt(left);
                freq.put(leftChar, freq.get(leftChar) - 1);
                if (freq.get(leftChar) == 0) freq.remove(leftChar);
                left++;
            }

            // Add count of substrings in current window
            res += (right - left + 1);
        }
        return res;
    }

    // Function to count substrings with exactly k distinct characters
    public static int countSubstrings(String s, int k) {
        return atMostKDistinct(s, k) - atMostKDistinct(s, k - 1);
    }
}

public class Main {
    public static void main(String[] args) {
        // Sample test
        String s = "pqpqs";
        int k = 2;

        // Output the result
        System.out.println("Count: " + Solution.countSubstrings(s, k)); // Output: 7
    }
}
```

Complexity Analysis

**Time Complexity: O(n)** for each call to atMostKDistinct.  
  
**Space Complexity: O(1)** map size bounded by 26 characters for alphabets.